![example workflow](https://github.com/donattion/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

158.160.35.73


# Проект YaMDb

Проект YaMDb собирает отзывы (Review) пользователей на произведения (Title). Произведения делятся на категории: "Книги", "Фильмы", "Музыка". Список категорий (Category) может быть расширен.
Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории "Книги" могут быть произведения "Винни Пух и все-все-все" и "Марсианские хроники", а в категории "Музыка" — песня "Давеча" группы "Насекомые" и вторая сюита Баха. Произведению может быть присвоен жанр из списка предустановленных (например, "Сказка", "Рок" или "Артхаус"). Новые жанры может создавать только администратор.
Благодарные или возмущённые читатели оставляют к произведениям текстовые отзывы (Review) и выставляют произведению рейтинг.

# Разворачивание проекта YaMDb

**Шаблон наполнения env-файла**:


Создайте файл  ```.env ``` в директории  ```../infra/ ```

Файл должен быть следющего содержания:

```
DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
DB_NAME=postgres # имя базы данных
POSTGRES_USER=postgres # логин для подключения к базе данных
POSTGRES_PASSWORD=postgres # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT=5432 # порт для подключения к БД
```

**Описание команд для запуска приложения в контейнерах**:


Откройте терминал в директории ```../infra/``` (там где находится файл ```docker-compose.yaml```)

Введите в терминал следующие команды:

```
#пересборка контейнера и запуск
docker-compose up -d --build
```

```
#сделать миграции
docker-compose exec web python manage.py makemigrations reviews
docker-compose exec web python manage.py migrate
```

```
#создать суперпользователя
docker-compose exec web python manage.py createsuperuser
```

```
#перенос статики
docker-compose exec web python manage.py collectstatic --no-input
```

Приложение будет доступно по адресу:

```
http://localhost

или

http://localhost/admin
```

**Описание команды для заполнения базы данными**:


Откройте терминал в директории ```../api_yamdb/``` (там где находится файл ```manage.py```)

Введите в терминал следующие команды:

```
python3 manage.py shell
# выполнить в открывшемся терминале:
>>> from django.contrib.contenttypes.models import ContentType
>>> ContentType.objects.all().delete()
>>> quit()
```

```
python manage.py loaddata fixtures.json
```

**Остановка и удаление контейнера**:

```
docker-compose down -v
```

Контейнеры остановлены и удалены вместе со всеми зависимостями. Остаются только образы.
